target <- aggregate(value~target, data=odvalue,FUN=sum)
write.csv(odvalue, file = "D:/Users/ZHIYONG/Desktop/SIA UK/UKsankey-placement.csv", row.names=FALSE)
plvalue <- data.frame(channel=character(),length=integer(),value=integer())
for(i in 1:nrow(data)){
for(h in 1:maxlen){
if(length(data$newpath[[i]]) == h){
for(j in 1:h){
channel <- data$newpath[[i]][j]
length <- h
value <- data$conversionvalue[[i]]/sum(data$newlen[[i]])*data$newlen[[i]][j]
plvalue <- rbind(plvalue, data.frame(channel,length,value,stringsAsFactors=FALSE))
}
break
}
}
}
write.csv(plvalue, file = "D:/Users/ZHIYONG/Desktop/SIA UK/SourceMedium-AttrSplit.csv", row.names=FALSE)
clvalue <- data.frame(channel=character(),LastClick=character(),value=integer())
for(i in 1:nrow(data)){
for(j in 1:(length(data$newpath[[i]]))){
if(j<length(data$newpath[[i]])){
channel <- data$newpath[[i]][j]
LastClick <- data$newpath[[i]][length(data$newpath[[i]])]
value <- data$conversionvalue[[i]]/sum(data$newlen[[i]])*data$newlen[[i]][j]
clvalue <- rbind(clvalue, data.frame(channel,LastClick,value,stringsAsFactors=FALSE))
}
}
}
write.csv(clvalue, file = "D:/Users/ZHIYONG/Desktop/SIA UK/SourceMedium-AttrSplit-channel.csv", row.names=FALSE)
for(i in 1:nrow(data)){
for(k in 1:nrow(attribution)){
if(data$newpath[[i]][length(data$newpath[[i]])] == attribution[[1]][k]){
attribution$lastclick[k] = attribution$lastclick[k] + data$conversionvalue[[i]]
}
}
for(j in 1:(length(data$newpath[[i]]))){
for(k in 1:nrow(attribution)){
if(data$newpath[[i]][j] == attribution[[1]][k]){
attribution$weighted[k] = attribution$weighted[k] + data$conversionvalue[[i]] / sum(data$newlen[[i]]) * data$newlen[[i]][j]
}
}
}
}
attribution$attribution = gsub("\\:i","",attribution$attribution)
attribution <- aggregate(lastclick+weighted~attribution, data=attribution,FUN=sum)
write.csv(attribution, file = "D:/Users/ZHIYONG/Desktop/SIA UK/attribution.csv", row.names=FALSE )
#################### Re-Map Path #####################
# data = Usage column: path | Created column : newpath
# mapping = Usage column: mapping = path,newpath
######################################################
RemapPath <- function(data,mapping){
print("Re-mapping Conversion Path in progress...")
pb   <- txtProgressBar(1, nrow(data), style=3)
data$newpath = data$path
for(i in 1:nrow(data)){
setTxtProgressBar(pb, i)
for(j in 1:length(data$path[[i]])){
for(k in 1:nrow(mapping)){
if(gsub("\\(impression\\)","",data$path[[i]][j]) == mapping$path[k]){
if(is.na(mapping$newpath[j])|mapping$newpath[j] == ""){
data$newpath[[i]][j] = as.character(mapping$path[k])
}else{
data$newpath[[i]][j] = as.character(mapping$newpath[k])
}
if(grepl("\\(impression\\)",data$path[[i]][j])){
data$newpath[[i]][j] = paste(data$newpath[[i]][j],":i",sep="")
}
break
}
}
}
}
return(data)
}
Attribution <- function(data,mapping,output,impression=0.5,customweight){
}
MergeSourcemediumPlacement <- function(data){
print("Merging SourceMedium & Placement...")
pb   <- txtProgressBar(1, length(data$sourcemedium), style=3)
data$sourcemedium = gsub(" ","",data$sourcemedium)
data$sourcemedium = strsplit(data$sourcemedium, ">")
data$placement = gsub(" ","",data$placement)
data$placement = strsplit(data$placement, ">")
##### Merge SourceMedium path + Placementpath with condition = "(unavailable)" #####
for(i in 1:length(data$sourcemedium)){
setTxtProgressBar(pb, i)
for(j in 1:length(data$sourcemedium[[i]])){
if(data$placement[[i]][j]=='(unavailable)'){
data$placement[[i]][j] = data$sourcemedium[[i]][j]
}
}
##### De-Duplicate Creative Size #####
data$placement[[i]] = gsub("\\d{2,3}[x|*]{1}\\d{2,3}", "", data$placement[[i]], perl=TRUE)
}
return(data)
}
RemapLastClick <- function(data,mapping){
data$newpath = lapply(data$newpath, function(x) unique(x))
for(i in 1:length(data$lastclick)){
for(j in 1:length(mapping$path)){
if(data$lastclick[[i]] == mapping$path[j]){
if(is.na(mapping$newpath[j])|mapping$newpath[j] == ""){
data$lastclick[[i]] = mapping$path[j]
}else{
data$lastclick[[i]] = mapping$newpath[j]
}
break
}
}
}
return(data)
}
AssignWeightedWeights <- function(data){
data$newlen <- data$newpath
for(i in 1:nrow(data)){
for(j in 1:length(data$newpath[[i]])){
if(length(unlist(strsplit(data$newpath[[i]][j], "[:i]"))) == 1){
data$newlen[[i]][j] = as.double(1)
}
else{
data$newlen[[i]][j] = as.double(0.5)
}
}
data$newlen[[i]] <- as.double(data$newlen[[i]])
}
}
library("data.table")
library("dplyr")
library("reshape2")
library("plyr")
data=fread("D:\Users\ZHIYONG\Desktop\Keyword performance report - zy.csv",header=T,",")
library("data.table")
library("dplyr")
library("reshape2")
library("plyr")
data=fread("D:\Users\ZHIYONG\Desktop\Keyword performance report - zy.csv",header=T,",")
library("data.table")
library("dplyr")
library("reshape2")
library("plyr")
data=fread("D:/Users/ZHIYONG/Desktop/Keyword performance report - zy.csv",header=T,",")
library("data.table")
library("dplyr")
library("reshape2")
library("plyr")
data=fread("D:/Users/ZHIYONG/Desktop/Keyword performance report - zy.csv",header=T,",",skip=skip = 5)
library("data.table")
library("dplyr")
library("reshape2")
library("plyr")
data=fread("D:/Users/ZHIYONG/Desktop/Keyword performance report - zy.csv",header=T,",",skip= 5)
library("data.table")
library("dplyr")
library("reshape2")
library("plyr")
data=fread("D:/Users/ZHIYONG/Desktop/Paid Search Traffic.csv",header=T,",",skip= 5)
library("data.table")
library("dplyr")
library("reshape2")
library("plyr")
data=fread("D:/Users/ZHIYONG/Desktop/Paid Search Traffic.csv",header=T,",")
library("data.table")
library("dplyr")
library("reshape2")
library("plyr")
maindata=fread("D:/Users/ZHIYONG/Desktop/Paid Search Traffic.csv",header=T,",")
library("data.table")
library("dplyr")
library("reshape2")
library("plyr")
maindata=fread("D:/Users/ZHIYONG/Desktop/Paid Search Traffic.csv",header=T,",")
cdata=fread("D:/Users/ZHIYONG/Desktop/Paid Search Traffic2.csv",header=T,",")
library("data.table")
library("dplyr")
library("reshape2")
library("plyr")
maindata=fread("D:/Users/ZHIYONG/Desktop/Paid Search Traffic.csv",header=T,",")
cdata=fread("D:/Users/ZHIYONG/Desktop/Paid Search Traffic2.csv",header=T,",")
overalldata = merge(maindata, cdata, by.x="new", by.y="new")
overalldata = merge(maindata, cdata, by.x="new", by.y="New")
library("data.table")
library("dplyr")
library("reshape2")
library("plyr")
maindata=fread("D:/Users/ZHIYONG/Desktop/Paid Search Traffic.csv",header=T,",")
cdata=fread("D:/Users/ZHIYONG/Desktop/Paid Search Traffic2.csv",header=T,",")
overalldata = merge(maindata, cdata, by.x="new", by.y="New",all.x = true)
library("data.table")
library("dplyr")
library("reshape2")
library("plyr")
maindata=fread("D:/Users/ZHIYONG/Desktop/Paid Search Traffic.csv",header=T,",")
cdata=fread("D:/Users/ZHIYONG/Desktop/Paid Search Traffic2.csv",header=T,",")
overalldata = merge(maindata, cdata, by.x="new", by.y="New",all.x = T)
kdata=fread("D:/Users/ZHIYONG/Desktop/Keyword performance report.csv",header=T,",",skip=5)
View(kdata)
kdata[,Account:=NULL]
kdata[,Cost:=NULL]
kdata[,new:=paste(Campaign, Day, sep="")]
library("data.table")
library("dplyr")
library("reshape2")
library("plyr")
maindata=fread("D:/Users/ZHIYONG/Desktop/Paid Search Traffic.csv",header=T,",")
cdata=fread("D:/Users/ZHIYONG/Desktop/Paid Search Traffic2.csv",header=T,",")
kdata=fread("D:/Users/ZHIYONG/Desktop/Keyword performance report.csv",header=T,",",skip=5)
kdata[,Cost:=NULL]
kdata[,Account:=NULL]
kdata[,new:=paste(Campaign, Day, sep="")]
library("data.table")
library("dplyr")
library("reshape2")
library("plyr")
maindata=fread("D:/Users/ZHIYONG/Desktop/Paid Search Traffic.csv",header=T,",")
cdata=fread("D:/Users/ZHIYONG/Desktop/Paid Search Traffic2.csv",header=T,",")
kdata=fread("D:/Users/ZHIYONG/Desktop/Keyword performance report.csv",header=T,",",skip=5)
kdata[,Cost:=NULL]
kdata[,Account:=NULL]
kdata[,new:=paste(Campaign, Day, sep="")]
kdata[,Day:=NULL]
kdata[,Campaign:=NULL]
overalldata = merge(maindata, cdata, by.x="new", by.y="New",all.x = T)
kdata2<- count(kdata, c('new'))
overalldata = merge(overalldata, kdata2, by.x="new", by.y="new",all.x = T)
View(overalldata)
library("data.table")
library("dplyr")
library("reshape2")
library("plyr")
maindata=fread("D:/Users/ZHIYONG/Desktop/Paid Search Traffic.csv",header=T,",")
cdata=fread("D:/Users/ZHIYONG/Desktop/Paid Search Traffic2.csv",header=T,",")
kdata=fread("D:/Users/ZHIYONG/Desktop/Keyword performance report.csv",header=T,",",skip=5)
kdata[,Cost:=NULL]
kdata[,Account:=NULL]
kdata[,new:=paste(Campaign, Day, sep="")]
kdata[,Day:=NULL]
kdata[,Campaign:=NULL]
overalldata = merge(maindata, cdata, by.x="new", by.y="New",all.x = T)
kdata2<- count(kdata, c('new'))
overalldata = merge(overalldata, kdata2, by.x="new", by.y="new",all.x = T)
View(overalldata)
library("data.table")
library("dplyr")
library("reshape2")
library("plyr")
maindata=fread("D:/Users/ZHIYONG/Desktop/Paid Search Traffic.csv",header=T,",")
cdata=fread("D:/Users/ZHIYONG/Desktop/Paid Search Traffic2.csv",header=T,",")
kdata=fread("D:/Users/ZHIYONG/Desktop/Keyword performance report.csv",header=T,",",skip=5)
kdata[,Cost:=NULL]
kdata[,Account:=NULL]
kdata[,new:=paste(Campaign, Day, sep="")]
kdata[,Day:=NULL]
kdata[,Campaign:=NULL]
overalldata = merge(maindata, cdata, by.x="new", by.y="New",all.x = T)
kdata2<- count(kdata, c('new'))
overalldata = merge(overalldata, kdata2, by.x="new", by.y="new",all.x = T)
overalldata = merge(maindata, cdata, by.x="new", by.y="new",all.x = T)
library("data.table")
library("dplyr")
library("reshape2")
library("plyr")
maindata=fread("D:/Users/ZHIYONG/Desktop/Paid Search Traffic.csv",header=T,",")
cdata=fread("D:/Users/ZHIYONG/Desktop/Paid Search Traffic2.csv",header=T,",")
kdata=fread("D:/Users/ZHIYONG/Desktop/Keyword performance report.csv",header=T,",",skip=5)
kdata[,Cost:=NULL]
kdata[,Account:=NULL]
kdata[,new:=paste(Campaign, Day, sep="")]
kdata[,Day:=NULL]
kdata[,Campaign:=NULL]
overalldata = merge(maindata, cdata, by.x="new", by.y="new",all.x = T)
kdata2<- count(kdata, c('new'))
overalldata = merge(overalldata, kdata2, by.x="new", by.y="new",all.x = T)
library("data.table")
library("dplyr")
library("reshape2")
library("plyr")
maindata=fread("D:/Users/ZHIYONG/Desktop/Paid Search Traffic.csv",header=T,",")
cdata=fread("D:/Users/ZHIYONG/Desktop/Paid Search Traffic2.csv",header=T,",")
kdata=fread("D:/Users/ZHIYONG/Desktop/Keyword performance report.csv",header=T,",",skip=5)
kdata[,Cost:=NULL]
kdata[,Account:=NULL]
kdata[,new:=paste(Campaign, Day, sep="")]
kdata[,Day:=NULL]
kdata[,Campaign:=NULL]
overalldata = merge(maindata, cdata, by.x="new", by.y="new",all.x = T)
kdata2<- count(kdata, c('new'))
overalldata = merge(overalldata, kdata2, by.x="new", by.y="new",all.x = T)
library("data.table")
library("dplyr")
library("reshape2")
library("plyr")
maindata=fread("D:/Users/ZHIYONG/Desktop/Paid Search Traffic.csv",header=T,",")
cdata=fread("D:/Users/ZHIYONG/Desktop/Paid Search Traffic2.csv",header=T,",")
library("data.table")
library("dplyr")
library("reshape2")
library("plyr")
maindata=fread("D:/Users/ZHIYONG/Desktop/Paid Search Traffic.csv",header=T,",")
cdata=fread("D:/Users/ZHIYONG/Desktop/Paid Search Traffic2.csv",header=T,",")
kdata=fread("D:/Users/ZHIYONG/Desktop/Keyword performance report.csv",header=T,",",skip=5)
kdata[,Cost:=NULL]
kdata[,Account:=NULL]
kdata[,new:=paste(Campaign, Day, sep="")]
kdata[,Day:=NULL]
kdata[,Campaign:=NULL]
overalldata = merge(maindata, cdata, by.x="new", by.y="new",all.x = T)
kdata2<- count(kdata, c('new'))
overalldata = merge(overalldata, kdata2, by.x="new", by.y="new",all.x = T)
library("data.table")
library("dplyr")
library("reshape2")
library("plyr")
maindata=fread("D:/Users/ZHIYONG/Desktop/Paid Search Traffic.csv",header=T,",")
cdata=fread("D:/Users/ZHIYONG/Desktop/Paid Search Traffic2.csv",header=T,",")
kdata=fread("D:/Users/ZHIYONG/Desktop/Keyword performance report.csv",header=T,",",skip=5)
kdata[,Cost:=NULL]
kdata[,Account:=NULL]
kdata[,new:=paste(Campaign, Day, sep="")]
kdata[,Day:=NULL]
kdata[,Campaign:=NULL]
overalldata = merge(maindata, cdata, by.x="new", by.y="new",all.x = T)
kdata2<- count(kdata, c('new'))
overalldata = merge(overalldata, kdata2, by.x="new", by.y="new",all.x = T)
View(overalldata)
library("data.table")
library("dplyr")
library("reshape2")
library("plyr")
maindata=fread("D:/Users/ZHIYONG/Desktop/Paid Search Traffic.csv",header=T,",")
cdata=fread("D:/Users/ZHIYONG/Desktop/Paid Search Traffic2.csv",header=T,",")
kdata=fread("D:/Users/ZHIYONG/Desktop/Keyword performance report.csv",header=T,",",skip=5)
kdata[,Cost:=NULL]
kdata[,Account:=NULL]
kdata[,new:=paste(Campaign, Day, sep="")]
kdata[,Day:=NULL]
kdata[,Campaign:=NULL]
overalldata = merge(maindata, cdata, by.x="new", by.y="new",all.x = T)
kdata2<- count(kdata, c('new'))
overalldata = merge(overalldata, kdata2, by.x="new", by.y="new",all.x = T)
write.csv(overalldata,"D:/Users/ZHIYONG/Desktop/SIA Data.csv")
library(ggplot2)
activity <- read.csv("./data/activity.csv")
activity$date <- as.POSIXct(activity$date, "%Y-%m-%d")
weekday <- weekdays(activity$date)
activity <- cbind(activity,weekday)
summary(activity)
---
title: "Reproducible Research: Peer Assessment 1"
output:
html_document:
keep_md: true
---
## Loading and preprocessing the data
library(ggplot2)
activity <- read.csv("./activity/activity.csv")
activity$date <- as.POSIXct(activity$date, "%Y-%m-%d")
weekday <- weekdays(activity$date)
activity <- cbind(activity,weekday)
summary(activity)
## What is mean total number of steps taken per day?
## What is the average daily activity pattern?
## Imputing missing values
## Are there differences in activity patterns between weekdays and weekends?
setwd("D:\Users\ZHIYONG\Documents\Github\Coursera-DataScience-JohnHopkins\Reproducible-Research-Coursework-1")
setwd("D:\\Users\\ZHIYONG\\Documents\\Github\\Coursera-DataScience-JohnHopkins\\Reproducible-Research-Coursework-1")
---
title: "Reproducible Research: Peer Assessment 1"
output:
html_document:
keep_md: true
---
## Loading and preprocessing the data
library(ggplot2)
activity <- read.csv("./activity/activity.csv")
activity$date <- as.POSIXct(activity$date, "%Y-%m-%d")
weekday <- weekdays(activity$date)
activity <- cbind(activity,weekday)
summary(activity)
## What is mean total number of steps taken per day?
## What is the average daily activity pattern?
## Imputing missing values
## Are there differences in activity patterns between weekdays and weekends?
library(ggplot2)
install.packages("ggplot2")
library(ggplot2)
activity <- read.csv("./activity/activity.csv")
activity$date <- as.POSIXct(activity$date, "%Y-%m-%d")
weekday <- weekdays(activity$date)
activity <- cbind(activity,weekday)
summary(activity)
library(ggplot2)
activity <- read.csv("./activity/activity.csv")
activity$date <- as.POSIXct(activity$date, "%Y-%m-%d")
weekday <- weekdays(activity$date)
activity <- cbind(activity,weekday)
summary(activity)
Sys.getenv("TZ")
Sys.setenv(TZ="Singapore")
Sys.getenv("TZ")
library(ggplot2)
activity <- read.csv("./activity/activity.csv")
activity$date <- as.POSIXct(activity$date, "%Y-%m-%d")
weekday <- weekdays(activity$date)
activity <- cbind(activity,weekday)
summary(activity)
Sys.setenv(TZ="Asia/Singapore")
library(ggplot2)
activity <- read.csv("./activity/activity.csv")
activity$date <- as.POSIXct(activity$date, "%Y-%m-%d")
weekday <- weekdays(activity$date)
activity <- cbind(activity,weekday)
summary(activity)
Sys.setenv(TZ="	Asia/Singapore")
Sys.setenv(TZ="Asia/Singapore")
Sys.getenv("TZ")
library(ggplot2)
activity <- read.csv("./activity/activity.csv")
activity$date <- as.POSIXct(activity$date, "%Y-%m-%d")
weekday <- weekdays(activity$date)
activity <- cbind(activity,weekday)
summary(activity)
activity$date <- as.POSIXct(activity$date, "%Y-%m-%d")
library(ggplot2)
activity <- read.csv("./activity/activity.csv")
activity$date <- as.POSIXct(activity$date, "%Y-%m-%d")
weekday <- weekdays(activity$date)
activity <- cbind(activity,weekday)
summary(activity)
activity$date <- as.POSIXct(activity$date, "%Y-%m-%d", "Asia/Singapore")
library(ggplot2)
activity <- read.csv("./activity/activity.csv")
activity$date <- as.POSIXct(activity$date, "%Y-%m-%d", "Asia/Singapore")
weekday <- weekdays(activity$date)
activity <- cbind(activity,weekday)
summary(activity)
?as.POSIXct
activity$date <- as.POSIXct(activity$date, "Asia/Singapore","%Y-%m-%d")
library(ggplot2)
activity <- read.csv("./activity/activity.csv")
activity$date <- as.POSIXct(activity$date, "Asia/Singapore","%Y-%m-%d")
weekday <- weekdays(activity$date)
activity <- cbind(activity,weekday)
summary(activity)
activity_total_steps <- with(activity, aggregate(steps, by = list(date), FUN = sum, na.rm = TRUE))
names(activity_total_steps) <- c("date", "steps")
hist(activity_total_steps$steps, main = "Total number of steps taken per day", xlab = "Total steps taken per day", col = "darkblue", ylim = c(0,20), breaks = seq(0,25000, by=2500))
library(ggplot2)
activity <- read.csv("./activity/activity.csv")
activity$date <- as.POSIXct(activity$date, "Asia/Singapore","%Y-%m-%d")
weekday <- weekdays(activity$date)
activity <- cbind(activity,weekday)
summary(activity)
activity_total_steps <- with(activity, aggregate(steps, by = list(date), FUN = sum, na.rm = TRUE))
names(activity_total_steps) <- c("date", "steps")
hist(activity_total_steps$steps, main = "Total number of steps taken per day", xlab = "Total steps taken per day", col = "darkblue", ylim = c(0,20), breaks = seq(0,25000, by=2500))
mean(activity_total_steps$steps)
median(activity_total_steps$steps)
average_daily_activity <- aggregate(activity$steps, by=list(activity$interval), FUN=mean, na.rm=TRUE)
names(average_daily_activity) <- c("interval", "mean")
plot(average_daily_activity$interval, average_daily_activity$mean, type = "l", col="darkblue", lwd = 2, xlab="Interval", ylab="Average number of steps", main="Average number of steps per intervals")
average_daily_activity[which.max(average_daily_activity$mean), ]$interval
sum(is.na(activity$steps))
imputed_steps <- average_daily_activity$mean[match(activity$interval, average_daily_activity$interval)]
activity_imputed <- transform(activity, steps = ifelse(is.na(activity$steps), yes = imputed_steps, no = activity$steps))
total_steps_imputed <- aggregate(steps ~ date, activity_imputed, sum)
names(total_steps_imputed) <- c("date", "daily_steps")
hist(total_steps_imputed$daily_steps, col = "darkblue", xlab = "Total steps per day", ylim = c(0,30), main = "Total number of steps taken each day", breaks = seq(0,25000,by=2500))
mean(total_steps_imputed$daily_steps)
median(total_steps_imputed$daily_steps)
activity$date <- as.Date(strptime(activity$date, format="%Y-%m-%d"))
activity$datetype <- sapply(activity$date, function(x) {
if (weekdays(x) == "Sábado" | weekdays(x) =="Domingo")
{y <- "Weekend"} else
{y <- "Weekday"}
y
})
library(ggplot2)
activity <- read.csv("./activity/activity.csv")
activity$date <- as.POSIXct(activity$date, "Asia/Singapore","%Y-%m-%d")
weekday <- weekdays(activity$date)
activity <- cbind(activity,weekday)
summary(activity)
activity_total_steps <- with(activity, aggregate(steps, by = list(date), FUN = sum, na.rm = TRUE))
names(activity_total_steps) <- c("date", "steps")
hist(activity_total_steps$steps, main = "Total number of steps taken per day", xlab = "Total steps taken per day", col = "darkblue", ylim = c(0,20), breaks = seq(0,25000, by=2500))
mean(activity_total_steps$steps)
median(activity_total_steps$steps)
average_daily_activity <- aggregate(activity$steps, by=list(activity$interval), FUN=mean, na.rm=TRUE)
names(average_daily_activity) <- c("interval", "mean")
plot(average_daily_activity$interval, average_daily_activity$mean, type = "l", col="darkblue", lwd = 2, xlab="Interval", ylab="Average number of steps", main="Average number of steps per intervals")
average_daily_activity[which.max(average_daily_activity$mean), ]$interval
sum(is.na(activity$steps))
imputed_steps <- average_daily_activity$mean[match(activity$interval, average_daily_activity$interval)]
activity_imputed <- transform(activity, steps = ifelse(is.na(activity$steps), yes = imputed_steps, no = activity$steps))
total_steps_imputed <- aggregate(steps ~ date, activity_imputed, sum)
names(total_steps_imputed) <- c("date", "daily_steps")
hist(total_steps_imputed$daily_steps, col = "darkblue", xlab = "Total steps per day", ylim = c(0,30), main = "Total number of steps taken each day", breaks = seq(0,25000,by=2500))
mean(total_steps_imputed$daily_steps)
median(total_steps_imputed$daily_steps)
activity$date <- as.Date(strptime(activity$date, format="%Y-%m-%d"))
activity$datetype <- sapply(activity$date, function(x) {
if (weekdays(x) == "Sábado" | weekdays(x) =="Domingo")
{y <- "Weekend"} else
{y <- "Weekday"}
y
})
activity_by_date <- aggregate(steps~interval + datetype, activity, mean, na.rm = TRUE)
plot<- ggplot(activity_by_date, aes(x = interval , y = steps, color = datetype)) +
geom_line() +
labs(title = "Average daily steps by type of date", x = "Interval", y = "Average number of steps") +
facet_wrap(~datetype, ncol = 1, nrow=2)
print(plot)
